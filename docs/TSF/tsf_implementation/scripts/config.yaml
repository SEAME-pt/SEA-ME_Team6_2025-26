# TSF Automation Configuration
# Centralized configuration for all TSF automation modules

# ============================================================================
# PATHS CONFIGURATION
# ============================================================================
paths:
  repo_root: "/Volumes/Important_Docs/42/SEA-ME_Team6_2025-26"
  tsf_implementation: "${paths.repo_root}/docs/TSF/tsf_implementation"
  items_dir: "${paths.tsf_implementation}/items"
  scripts_dir: "${paths.tsf_implementation}/scripts"
  modules_dir: "${paths.scripts_dir}/modules"
  tools_dir: "${paths.tsf_implementation}/tools"
  graph_dir: "${paths.tsf_implementation}/graph"
  sprints_dir: "${paths.repo_root}/docs/sprints"
  requirements_table: "${paths.repo_root}/docs/TSF/requirements/tsf-requirements-table.md"

  # TruDAG paths
  trudag_db: "${paths.tsf_implementation}/.dotstop.dot"
  trudag_items: "${paths.tsf_implementation}/.trudag_items"
  graph_file: "${paths.graph_dir}/graph.dot"

# ============================================================================
# AI CONFIGURATION
# ============================================================================
ai:
  # Primary method: "manual" (Option G - Semi-automated with VSCode/Claude)
  # Fallback: "copilot_cli" (Option C - gh copilot CLI)
  primary_method: "manual"

  # Fallback methods in order of preference
  fallbacks: ["copilot_cli"]

  # Manual generation settings (Option G - Semi-automated)
  manual:
    # Opens file in VSCode and pauses for user to request AI generation
    open_in_vscode: true
    show_prompt_suggestion: true
    wait_for_user_confirmation: true
    # Suggested prompt template for Claude/Copilot
    prompt_template: |
      Generate content for TSF item {item_type}-L0-{id}:
      - Requirement: {requirement}
      - Acceptance Criteria: {acceptance_criteria}
      - Fill the header, text, and references fields appropriately.
      - Use the existing file structure, only fill empty fields.

  # Copilot CLI settings (Option C - Fallback)
  copilot:
    timeout: 30  # seconds
    max_retries: 3
    retry_delay: 2  # seconds

# ============================================================================
# DETECTION CONFIGURATION
# ============================================================================
detection:
  # Patterns for finding new requirements
  requirement_pattern: "L0-(\\d+)"
  expect_pattern: "EXPECT-L0-(\\d+)"

  # File extensions to monitor
  monitored_extensions: [".md"]

  # Ignore patterns
  ignore_patterns:
    - "*.git*"
    - "*node_modules*"
    - "*.DS_Store"

# ============================================================================
# GENERATION CONFIGURATION
# ============================================================================
generation:
  # Output structure
  categories:
    - expectations
    - assertions
    - evidences
    - assumptions

  # Template settings
  templates:
    level_default: "1.1"
    normative_default: true

  # File naming
  file_prefix:
    expectations: "EXPECT-L0-"
    assertions: "ASSERT-L0-"
    evidences: "EVID-L0-"
    assumptions: "ASSUMP-L0-"

# ============================================================================
# VALIDATION CONFIGURATION
# ============================================================================
validation:
  # Required front-matter fields
  required_fields:
    - id
    - header
    - text
    - level
    - normative

  # Level format validation
  level_pattern: "^\\d+\\.\\d+$"

  # Reference validation
  reference_types:
    - "file"
    - "url"

  # Severity levels for issues
  severity:
    error:
      - "missing_required_field"
      - "invalid_level_format"
      - "broken_file_reference"
    warning:
      - "missing_references"
      - "inconsistent_naming"

  # Validation output
  output_format: "detailed"  # "summary" or "detailed"

# ============================================================================
# EVIDENCE SYNC CONFIGURATION
# ============================================================================
evidence_sync:
  # Sprint file patterns
  sprint_pattern: "sprint*.md"
  sprint_files:
    - "sprint1.md"
    - "sprint2.md"
    - "sprint3.md"
    - "sprint4.md"
    - "sprint5.md"

  # Sections to parse for evidence
  evidence_sections:
    - "Outcomes"
    - "Demos"
    - "Delivered"
    - "TSF Useful"

  # Evidence patterns are defined in the Python script for better regex handling
  # See EvidenceParser class in the main script

  # File existence checks
  check_file_existence: true

  # Update behavior
  update_mode: "append"

# ============================================================================
# TRUDAG CONFIGURATION
# ============================================================================
trudag:
  # Database settings
  db_name: ".dotstop.dot"

  # Item creation settings
  create_missing_items: true
  overwrite_existing: false

  # Link application
  apply_links: true
  validate_after_link: true

  # Validation settings
  run_validation: true
  strict_validation: false

# ============================================================================
# LOGGING CONFIGURATION
# ============================================================================
logging:
  level: "INFO"  # DEBUG, INFO, WARNING, ERROR
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
  file: "${paths.tsf_implementation}/tsf_automation.log"

  # Console output
  console: true
  console_level: "INFO"

# ============================================================================
# PERFORMANCE CONFIGURATION
# ============================================================================
performance:
  # Caching
  enable_cache: true
  cache_dir: "${paths.tsf_implementation}/.cache"
  cache_expiry: 3600  # seconds

  # Parallel processing
  max_workers: 4
  parallel_file_processing: true

  # Incremental updates
  incremental_detection: true
  incremental_generation: true

# ============================================================================
# INTEGRATION CONFIGURATION
# ============================================================================
integration:
  # GitHub settings
  github:
    token_env_var: "GITHUB_TOKEN"
    api_timeout: 10

  # External tools
  tools:
    graph_generator: "${paths.tools_dir}/generate_graph_from_heuristics.py"
    trudag_command: "trudag"

  # Notifications
  notifications:
    enabled: false
    on_success: false
    on_failure: true